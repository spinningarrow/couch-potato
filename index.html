<title>TV List</title>

<div id="react-app"></div>

<script
  src="https://unpkg.com/react@18/umd/react.development.js"
  crossorigin
></script>
<script
  src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
  crossorigin
></script>

<script type="module">
  import * as api from "./api.mjs";

  const e = React.createElement;

  const SearchForm = ({ handleSearch }) => {
    return e(
      "form",
      { onSubmit: handleSearch },
      e("input", { type: "search" }),
      e("button", { type: "submit" }, "Search")
    );
  };

  const SearchResult = ({ id, image }) => {
    return e(
      "span",
      {},
      e("img", {
        src:
          image?.medium ||
          image?.original ||
          "https://via.placeholder.com/200x300",
        title: id,
      })
    );
  };

  const SearchResults = ({ results }) => {
    return e(
      "div",
      {},
      (results || []).map((result) =>
        e(SearchResult, { key: result.id, ...result })
      )
    );
  };

  const App = (props) => {
    const [results, setResults] = React.useState([]);

    return e(
      "div",
      {},
      e(SearchForm, {
        handleSearch: async (event) => {
          event.preventDefault();
          const query = event.target.elements[0].value;
          console.log("query was", query);

          const results = await api.search(query);
          console.log("search results", results);
          setResults(results);

          return false;
        },
      }),
      e(SearchResults, { results })
    );
  };

  const domContainer = document.querySelector("#react-app");
  const root = ReactDOM.createRoot(domContainer);
  root.render(e(App));
</script>
